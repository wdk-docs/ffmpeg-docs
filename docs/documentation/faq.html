

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FFmpeg FAQ &mdash; ffmpeg-docs v2019.06.09 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="author" title="关于这些文档" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="General Documentation" href="general.html" />
    <link rel="prev" title="Libavfilter Documentation" href="libraries/libavfilter.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../contents.html" class="icon icon-home"> ffmpeg-docs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">FFmpeg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">关于FFmpeg</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">文档</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#command-line-tools-documentation">Command Line Tools Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#components-documentation">Components Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#libraries-documentation">Libraries Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#general-documentation">General Documentation</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">FFmpeg FAQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="general.html">General Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="platform.html">Platform Specific Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="git-howto.html">Using Git to develop FFmpeg</a></li>
<li class="toctree-l3"><a class="reference internal" href="fate.html">FFmpeg Automated Testing Environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#api-documentation">API Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#community-contributed-documentation">Community Contributed Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#books-about-ffmpeg">Books about FFmpeg</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../download.html">下载FFmpeg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../news.html">新闻</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">联系我们</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugreports.html">错误报告</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wiki.html">欢迎来到FFmpeg Bug Tracker和Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donations.html">捐赠</a></li>
<li class="toctree-l1"><a class="reference internal" href="../consulting.html">与FFmpeg相关的咨询和就业机会</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">FFmpeg安全</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legal.html">FFmpeg许可和法律注意事项</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../contents.html">ffmpeg-docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">文档</a> &raquo;</li>
        
      <li>FFmpeg FAQ</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/documentation/faq.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ffmpeg-faq">
<h1>FFmpeg FAQ<a class="headerlink" href="#ffmpeg-faq" title="永久链接至标题">¶</a></h1>
<p>Table of Contents
1 General Questions
1.1 Why doesn’t FFmpeg support feature [xyz]?
1.2 FFmpeg does not support codec XXX. Can you include a Windows DLL loader to support it?
1.3 I cannot read this file although this format seems to be supported by ffmpeg.
1.4 Which codecs are supported by Windows?
2 Compilation
2.1 error: can’t find a register in class ‘GENERAL_REGS’ while reloading ‘asm’
2.2 I have installed this library with my distro’s package manager. Why does configure not see it?
2.3 How do I make pkg-config find my libraries?
2.4 How do I use pkg-config when cross-compiling?
3 Usage
3.1 ffmpeg does not work; what is wrong?
3.2 How do I encode single pictures into movies?
3.3 How do I encode movie to single pictures?
3.4 Why do I see a slight quality degradation with multithreaded MPEG* encoding?
3.5 How can I read from the standard input or write to the standard output?
3.6 -f jpeg doesn’t work.
3.7 Why can I not change the frame rate?
3.8 How do I encode Xvid or DivX video with ffmpeg?
3.9 Which are good parameters for encoding high quality MPEG-4?
3.10 Which are good parameters for encoding high quality MPEG-1/MPEG-2?
3.11 Interlaced video looks very bad when encoded with ffmpeg, what is wrong?
3.12 How can I read DirectShow files?
3.13 How can I join video files?
3.14 How can I concatenate video files?
3.14.1 Concatenating using the concat filter
3.14.2 Concatenating using the concat demuxer
3.14.3 Concatenating using the concat protocol (file level)
3.14.4 Concatenating using raw audio and video
3.15 Using -f lavfi, audio becomes mono for no apparent reason.
3.16 Why does FFmpeg not see the subtitles in my VOB file?
3.17 Why was the ffmpeg -sameq option removed? What to use instead?
3.18 I have a stretched video, why does scaling does not fix it?
3.19 How do I run ffmpeg as a background task?
3.20 How do I prevent ffmpeg from suspending with a message like suspended (tty output)?
4 Development
4.1 Are there examples illustrating how to use the FFmpeg libraries, particularly libavcodec and libavformat?
4.2 Can you support my C compiler XXX?
4.3 Is Microsoft Visual C++ supported?
4.4 Can you add automake, libtool or autoconf support?
4.5 Why not rewrite FFmpeg in object-oriented C++?
4.6 Why are the ffmpeg programs devoid of debugging symbols?
4.7 I do not like the LGPL, can I contribute code under the GPL instead?
4.8 I’m using FFmpeg from within my C application but the linker complains about missing symbols from the libraries themselves.
4.9 I’m using FFmpeg from within my C++ application but the linker complains about missing symbols which seem to be available.
4.10 I’m using libavutil from within my C++ application but the compiler complains about ’UINT64_C’ was not declared in this scope
4.11 I have a file in memory / a API different from <a href="#id1"><span class="problematic" id="id2">*</span></a>open/<a href="#id3"><span class="problematic" id="id4">*</span></a>read/ libc how do I use it with libavformat?
4.12 Where is the documentation about ffv1, msmpeg4, asv1, 4xm?
4.13 How do I feed H.263-RTP (and other codecs in RTP) to libavcodec?
4.14 AVStream.r_frame_rate is wrong, it is much larger than the frame rate.
4.15 Why is make fate not running all tests?
4.16 Why is make fate not finding the samples?
1 General Questions
1.1 Why doesn’t FFmpeg support feature [xyz]?
Because no one has taken on that task yet. FFmpeg development is driven by the tasks that are important to the individual developers. If there is a feature that is important to you, the best way to get it implemented is to undertake the task yourself or sponsor a developer.</p>
<p>1.2 FFmpeg does not support codec XXX. Can you include a Windows DLL loader to support it?
No. Windows DLLs are not portable, bloated and often slow. Moreover FFmpeg strives to support all codecs natively. A DLL loader is not conducive to that goal.</p>
<p>1.3 I cannot read this file although this format seems to be supported by ffmpeg.
Even if ffmpeg can read the container format, it may not support all its codecs. Please consult the supported codec list in the ffmpeg documentation.</p>
<p>1.4 Which codecs are supported by Windows?
Windows does not support standard formats like MPEG very well, unless you install some additional codecs.</p>
<p>The following list of video codecs should work on most Windows systems:</p>
<p>msmpeg4v2
.avi/.asf</p>
<p>msmpeg4
.asf only</p>
<p>wmv1
.asf only</p>
<p>wmv2
.asf only</p>
<p>mpeg4
Only if you have some MPEG-4 codec like ffdshow or Xvid installed.</p>
<p>mpeg1video
.mpg only</p>
<p>Note, ASF files often have .wmv or .wma extensions in Windows. It should also be mentioned that Microsoft claims a patent on the ASF format, and may sue or threaten users who create ASF files with non-Microsoft software. It is strongly advised to avoid ASF where possible.</p>
<p>The following list of audio codecs should work on most Windows systems:</p>
<p>adpcm_ima_wav
adpcm_ms
pcm_s16le
always</p>
<p>libmp3lame
If some MP3 codec like LAME is installed.</p>
<p>2 Compilation
2.1 error: can’t find a register in class ‘GENERAL_REGS’ while reloading ‘asm’
This is a bug in gcc. Do not report it to us. Instead, please report it to the gcc developers. Note that we will not add workarounds for gcc bugs.</p>
<p>Also note that (some of) the gcc developers believe this is not a bug or not a bug they should fix: <a class="reference external" href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=11203">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=11203</a>. Then again, some of them do not know the difference between an undecidable problem and an NP-hard problem…</p>
<p>2.2 I have installed this library with my distro’s package manager. Why does configure not see it?
Distributions usually split libraries in several packages. The main package contains the files necessary to run programs using the library. The development package contains the files necessary to build programs using the library. Sometimes, docs and/or data are in a separate package too.</p>
<p>To build FFmpeg, you need to install the development package. It is usually called libfoo-dev or libfoo-devel. You can remove it after the build is finished, but be sure to keep the main package.</p>
<p>2.3 How do I make pkg-config find my libraries?
Somewhere along with your libraries, there is a .pc file (or several) in a pkgconfig directory. You need to set environment variables to point pkg-config to these files.</p>
<p>If you need to add directories to pkg-config’s search list (typical use case: library installed separately), add it to $PKG_CONFIG_PATH:</p>
<p>export PKG_CONFIG_PATH=/opt/x264/lib/pkgconfig:/opt/opus/lib/pkgconfig
If you need to replace pkg-config’s search list (typical use case: cross-compiling), set it in $PKG_CONFIG_LIBDIR:</p>
<p>export PKG_CONFIG_LIBDIR=/home/me/cross/usr/lib/pkgconfig:/home/me/cross/usr/local/lib/pkgconfig
If you need to know the library’s internal dependencies (typical use: static linking), add the –static option to pkg-config:</p>
<p>./configure –pkg-config-flags=–static
2.4 How do I use pkg-config when cross-compiling?
The best way is to install pkg-config in your cross-compilation environment. It will automatically use the cross-compilation libraries.</p>
<p>You can also use pkg-config from the host environment by specifying explicitly –pkg-config=pkg-config to configure. In that case, you must point pkg-config to the correct directories using the PKG_CONFIG_LIBDIR, as explained in the previous entry.</p>
<p>As an intermediate solution, you can place in your cross-compilation environment a script that calls the host pkg-config with PKG_CONFIG_LIBDIR set. That script can look like that:</p>
<p>#!/bin/sh
PKG_CONFIG_LIBDIR=/path/to/cross/lib/pkgconfig
export PKG_CONFIG_LIBDIR
exec /usr/bin/pkg-config “$&#64;”
3 Usage
3.1 ffmpeg does not work; what is wrong?
Try a make distclean in the ffmpeg source directory before the build. If this does not help see (<a class="reference external" href="https://ffmpeg.org/bugreports.html">https://ffmpeg.org/bugreports.html</a>).</p>
<p>3.2 How do I encode single pictures into movies?
First, rename your pictures to follow a numerical sequence. For example, img1.jpg, img2.jpg, img3.jpg,… Then you may run:</p>
<p>ffmpeg -f image2 -i img%d.jpg /tmp/a.mpg
Notice that ‘%d’ is replaced by the image number.</p>
<p>img%03d.jpg means the sequence img001.jpg, img002.jpg, etc.</p>
<p>Use the -start_number option to declare a starting number for the sequence. This is useful if your sequence does not start with img001.jpg but is still in a numerical order. The following example will start with img100.jpg:</p>
<p>ffmpeg -f image2 -start_number 100 -i img%d.jpg /tmp/a.mpg
If you have large number of pictures to rename, you can use the following command to ease the burden. The command, using the bourne shell syntax, symbolically links all files in the current directory that match <a href="#id5"><span class="problematic" id="id6">*</span></a>jpg to the /tmp directory in the sequence of img001.jpg, img002.jpg and so on.</p>
<p>x=1; for i in <a href="#id7"><span class="problematic" id="id8">*</span></a>jpg; do counter=$(printf %03d $x); ln -s “$i” /tmp/img”$counter”.jpg; x=$(($x+1)); done
If you want to sequence them by oldest modified first, substitute $(ls -r -t <a href="#id9"><span class="problematic" id="id10">*</span></a>jpg) in place of <a href="#id11"><span class="problematic" id="id12">*</span></a>jpg.</p>
<p>Then run:</p>
<p>ffmpeg -f image2 -i /tmp/img%03d.jpg /tmp/a.mpg
The same logic is used for any image format that ffmpeg reads.</p>
<p>You can also use cat to pipe images to ffmpeg:</p>
<p>cat <a href="#id13"><span class="problematic" id="id14">*</span></a>.jpg | ffmpeg -f image2pipe -c:v mjpeg -i - output.mpg
3.3 How do I encode movie to single pictures?
Use:</p>
<p>ffmpeg -i movie.mpg movie%d.jpg
The movie.mpg used as input will be converted to movie1.jpg, movie2.jpg, etc…</p>
<p>Instead of relying on file format self-recognition, you may also use</p>
<p>-c:v ppm
-c:v png
-c:v mjpeg
to force the encoding.</p>
<p>Applying that to the previous example:</p>
<p>ffmpeg -i movie.mpg -f image2 -c:v mjpeg menu%d.jpg
Beware that there is no “jpeg” codec. Use “mjpeg” instead.</p>
<p>3.4 Why do I see a slight quality degradation with multithreaded MPEG* encoding?
For multithreaded MPEG* encoding, the encoded slices must be independent, otherwise thread n would practically have to wait for n-1 to finish, so it’s quite logical that there is a small reduction of quality. This is not a bug.</p>
<p>3.5 How can I read from the standard input or write to the standard output?
Use - as file name.</p>
<p>3.6 -f jpeg doesn’t work.
Try ’-f image2 test%d.jpg’.</p>
<p>3.7 Why can I not change the frame rate?
Some codecs, like MPEG-1/2, only allow a small number of fixed frame rates. Choose a different codec with the -c:v command line option.</p>
<p>3.8 How do I encode Xvid or DivX video with ffmpeg?
Both Xvid and DivX (version 4+) are implementations of the ISO MPEG-4 standard (note that there are many other coding formats that use this same standard). Thus, use ’-c:v mpeg4’ to encode in these formats. The default fourcc stored in an MPEG-4-coded file will be ’FMP4’. If you want a different fourcc, use the ’-vtag’ option. E.g., ’-vtag xvid’ will force the fourcc ’xvid’ to be stored as the video fourcc rather than the default.</p>
<p>3.9 Which are good parameters for encoding high quality MPEG-4?
’-mbd rd -flags +mv4+aic -trellis 2 -cmp 2 -subcmp 2 -g 300 -pass 1/2’, things to try: ’-bf 2’, ’-mpv_flags qp_rd’, ’-mpv_flags mv0’, ’-mpv_flags skip_rd’.</p>
<p>3.10 Which are good parameters for encoding high quality MPEG-1/MPEG-2?
’-mbd rd -trellis 2 -cmp 2 -subcmp 2 -g 100 -pass 1/2’ but beware the ’-g 100’ might cause problems with some decoders. Things to try: ’-bf 2’, ’-mpv_flags qp_rd’, ’-mpv_flags mv0’, ’-mpv_flags skip_rd’.</p>
<p>3.11 Interlaced video looks very bad when encoded with ffmpeg, what is wrong?
You should use ’-flags +ilme+ildct’ and maybe ’-flags +alt’ for interlaced material, and try ’-top 0/1’ if the result looks really messed-up.</p>
<p>3.12 How can I read DirectShow files?
If you have built FFmpeg with ./configure –enable-avisynth (only possible on MinGW/Cygwin platforms), then you may use any file that DirectShow can read as input.</p>
<p>Just create an “input.avs” text file with this single line …</p>
<p>DirectShowSource(“C:path to your fileyourfile.asf”)
… and then feed that text file to ffmpeg:</p>
<p>ffmpeg -i input.avs
For ANY other help on AviSynth, please visit the AviSynth homepage.</p>
<p>3.13 How can I join video files?
To “join” video files is quite ambiguous. The following list explains the different kinds of “joining” and points out how those are addressed in FFmpeg. To join video files may mean:</p>
<p>To put them one after the other: this is called to concatenate them (in short: concat) and is addressed in this very faq.
To put them together in the same file, to let the user choose between the different versions (example: different audio languages): this is called to multiplex them together (in short: mux), and is done by simply invoking ffmpeg with several -i options.
For audio, to put all channels together in a single stream (example: two mono streams into one stereo stream): this is sometimes called to merge them, and can be done using the amerge filter.
For audio, to play one on top of the other: this is called to mix them, and can be done by first merging them into a single stream and then using the pan filter to mix the channels at will.
For video, to display both together, side by side or one on top of a part of the other; it can be done using the overlay video filter.
3.14 How can I concatenate video files?
There are several solutions, depending on the exact circumstances.</p>
<p>3.14.1 Concatenating using the concat filter
FFmpeg has a concat filter designed specifically for that, with examples in the documentation. This operation is recommended if you need to re-encode.</p>
<p>3.14.2 Concatenating using the concat demuxer
FFmpeg has a concat demuxer which you can use when you want to avoid a re-encode and your format doesn’t support file level concatenation.</p>
<p>3.14.3 Concatenating using the concat protocol (file level)
FFmpeg has a concat protocol designed specifically for that, with examples in the documentation.</p>
<p>A few multimedia containers (MPEG-1, MPEG-2 PS, DV) allow one to concatenate video by merely concatenating the files containing them.</p>
<p>Hence you may concatenate your multimedia files by first transcoding them to these privileged formats, then using the humble cat command (or the equally humble copy under Windows), and finally transcoding back to your format of choice.</p>
<p>ffmpeg -i input1.avi -qscale:v 1 intermediate1.mpg
ffmpeg -i input2.avi -qscale:v 1 intermediate2.mpg
cat intermediate1.mpg intermediate2.mpg &gt; intermediate_all.mpg
ffmpeg -i intermediate_all.mpg -qscale:v 2 output.avi
Additionally, you can use the concat protocol instead of cat or copy which will avoid creation of a potentially huge intermediate file.</p>
<p>ffmpeg -i input1.avi -qscale:v 1 intermediate1.mpg
ffmpeg -i input2.avi -qscale:v 1 intermediate2.mpg
ffmpeg -i concat:”intermediate1.mpg|intermediate2.mpg” -c copy intermediate_all.mpg
ffmpeg -i intermediate_all.mpg -qscale:v 2 output.avi
Note that you may need to escape the character “|” which is special for many shells.</p>
<p>Another option is usage of named pipes, should your platform support it:</p>
<p>mkfifo intermediate1.mpg
mkfifo intermediate2.mpg
ffmpeg -i input1.avi -qscale:v 1 -y intermediate1.mpg &lt; /dev/null &amp;
ffmpeg -i input2.avi -qscale:v 1 -y intermediate2.mpg &lt; /dev/null &amp;
cat intermediate1.mpg intermediate2.mpg <a href="#id15"><span class="problematic" id="id16">|</span></a>ffmpeg -f mpeg -i - -c:v mpeg4 -c:a libmp3lame output.avi
3.14.4 Concatenating using raw audio and video
Similarly, the yuv4mpegpipe format, and the raw video, raw audio codecs also allow concatenation, and the transcoding step is almost lossless. When using multiple yuv4mpegpipe(s), the first line needs to be discarded from all but the first stream. This can be accomplished by piping through tail as seen below. Note that when piping through tail you must use command grouping, { ;}, to background properly.</p>
<p>For example, let’s say we want to concatenate two FLV files into an output.flv file:</p>
<p>mkfifo temp1.a
mkfifo temp1.v
mkfifo temp2.a
mkfifo temp2.v
mkfifo all.a
mkfifo all.v
ffmpeg -i input1.flv -vn -f u16le -c:a pcm_s16le -ac 2 -ar 44100 - &gt; temp1.a &lt; /dev/null &amp;
ffmpeg -i input2.flv -vn -f u16le -c:a pcm_s16le -ac 2 -ar 44100 - &gt; temp2.a &lt; /dev/null &amp;
ffmpeg -i input1.flv -an -f yuv4mpegpipe - &gt; temp1.v &lt; /dev/null &amp;
{ ffmpeg -i input2.flv -an -f yuv4mpegpipe - &lt; /dev/null | tail -n +2 &gt; temp2.v ; } &amp;
cat temp1.a temp2.a &gt; all.a &amp;
cat temp1.v temp2.v &gt; all.v &amp;
ffmpeg -f u16le -c:a pcm_s16le -ac 2 -ar 44100 -i all.a </p>
<blockquote>
<div><p>-f yuv4mpegpipe -i all.v -y output.flv</p>
</div></blockquote>
<p>rm temp[12].[av] all.[av]
3.15 Using -f lavfi, audio becomes mono for no apparent reason.
Use -dumpgraph - to find out exactly where the channel layout is lost.</p>
<p>Most likely, it is through auto-inserted aresample. Try to understand why the converting filter was needed at that place.</p>
<p>Just before the output is a likely place, as -f lavfi currently only support packed S16.</p>
<p>Then insert the correct aformat explicitly in the filtergraph, specifying the exact format.</p>
<p>aformat=sample_fmts=s16:channel_layouts=stereo
3.16 Why does FFmpeg not see the subtitles in my VOB file?
VOB and a few other formats do not have a global header that describes everything present in the file. Instead, applications are supposed to scan the file to see what it contains. Since VOB files are frequently large, only the beginning is scanned. If the subtitles happen only later in the file, they will not be initially detected.</p>
<p>Some applications, including the ffmpeg command-line tool, can only work with streams that were detected during the initial scan; streams that are detected later are ignored.</p>
<p>The size of the initial scan is controlled by two options: probesize (default ~5 Mo) and analyzeduration (default 5,000,000 µs = 5 s). For the subtitle stream to be detected, both values must be large enough.</p>
<p>3.17 Why was the ffmpeg -sameq option removed? What to use instead?
The -sameq option meant “same quantizer”, and made sense only in a very limited set of cases. Unfortunately, a lot of people mistook it for “same quality” and used it in places where it did not make sense: it had roughly the expected visible effect, but achieved it in a very inefficient way.</p>
<p>Each encoder has its own set of options to set the quality-vs-size balance, use the options for the encoder you are using to set the quality level to a point acceptable for your tastes. The most common options to do that are -qscale and -qmax, but you should peruse the documentation of the encoder you chose.</p>
<p>3.18 I have a stretched video, why does scaling does not fix it?
A lot of video codecs and formats can store the aspect ratio of the video: this is the ratio between the width and the height of either the full image (DAR, display aspect ratio) or individual pixels (SAR, sample aspect ratio). For example, EGA screens at resolution 640×350 had 4:3 DAR and 35:48 SAR.</p>
<p>Most still image processing work with square pixels, i.e. 1:1 SAR, but a lot of video standards, especially from the analogic-numeric transition era, use non-square pixels.</p>
<p>Most processing filters in FFmpeg handle the aspect ratio to avoid stretching the image: cropping adjusts the DAR to keep the SAR constant, scaling adjusts the SAR to keep the DAR constant.</p>
<p>If you want to stretch, or “unstretch”, the image, you need to override the information with the setdar or setsar filters.</p>
<p>Do not forget to examine carefully the original video to check whether the stretching comes from the image or from the aspect ratio information.</p>
<p>For example, to fix a badly encoded EGA capture, use the following commands, either the first one to upscale to square pixels or the second one to set the correct aspect ratio or the third one to avoid transcoding (may not work depending on the format / codec / player / phase of the moon):</p>
<p>ffmpeg -i ega_screen.nut -vf scale=640:480,setsar=1 ega_screen_scaled.nut
ffmpeg -i ega_screen.nut -vf setdar=4/3 ega_screen_anamorphic.nut
ffmpeg -i ega_screen.nut -aspect 4/3 -c copy ega_screen_overridden.nut
3.19 How do I run ffmpeg as a background task?
ffmpeg normally checks the console input, for entries like “q” to stop and “?” to give help, while performing operations. ffmpeg does not have a way of detecting when it is running as a background task. When it checks the console input, that can cause the process running ffmpeg in the background to suspend.</p>
<p>To prevent those input checks, allowing ffmpeg to run as a background task, use the -nostdin option in the ffmpeg invocation. This is effective whether you run ffmpeg in a shell or invoke ffmpeg in its own process via an operating system API.</p>
<p>As an alternative, when you are running ffmpeg in a shell, you can redirect standard input to /dev/null (on Linux and macOS) or NUL (on Windows). You can do this redirect either on the ffmpeg invocation, or from a shell script which calls ffmpeg.</p>
<p>For example:</p>
<p>ffmpeg -nostdin -i INPUT OUTPUT
or (on Linux, macOS, and other UNIX-like shells):</p>
<p>ffmpeg -i INPUT OUTPUT &lt;/dev/null
or (on Windows):</p>
<p>ffmpeg -i INPUT OUTPUT &lt;NUL
3.20 How do I prevent ffmpeg from suspending with a message like suspended (tty output)?
If you run ffmpeg in the background, you may find that its process suspends. There may be a message like suspended (tty output). The question is how to prevent the process from being suspended.</p>
<p>For example:</p>
<p>% ffmpeg -i INPUT OUTPUT &amp;&gt; ~/tmp/log.txt &amp;
[1] 93352
%
[1]  + suspended (tty output)  ffmpeg -i INPUT OUTPUT &amp;&gt;
The message “tty output” notwithstanding, the problem here is that ffmpeg normally checks the console input when it runs. The operating system detects this, and suspends the process until you can bring it to the foreground and attend to it.</p>
<p>The solution is to use the right techniques to tell ffmpeg not to consult console input. You can use the -nostdin option, or redirect standard input with &lt; /dev/null. See FAQ How do I run ffmpeg as a background task? for details.</p>
<p>4 Development
4.1 Are there examples illustrating how to use the FFmpeg libraries, particularly libavcodec and libavformat?
Yes. Check the doc/examples directory in the source repository, also available online at: <a class="reference external" href="https://github.com/FFmpeg/FFmpeg/tree/master/doc/examples">https://github.com/FFmpeg/FFmpeg/tree/master/doc/examples</a>.</p>
<p>Examples are also installed by default, usually in $PREFIX/share/ffmpeg/examples.</p>
<p>Also you may read the Developers Guide of the FFmpeg documentation. Alternatively, examine the source code for one of the many open source projects that already incorporate FFmpeg at (projects.html).</p>
<p>4.2 Can you support my C compiler XXX?
It depends. If your compiler is C99-compliant, then patches to support it are likely to be welcome if they do not pollute the source code with #ifdefs related to the compiler.</p>
<p>4.3 Is Microsoft Visual C++ supported?
Yes. Please see the Microsoft Visual C++ section in the FFmpeg documentation.</p>
<p>4.4 Can you add automake, libtool or autoconf support?
No. These tools are too bloated and they complicate the build.</p>
<p>4.5 Why not rewrite FFmpeg in object-oriented C++?
FFmpeg is already organized in a highly modular manner and does not need to be rewritten in a formal object language. Further, many of the developers favor straight C; it works for them. For more arguments on this matter, read “Programming Religion”.</p>
<p>4.6 Why are the ffmpeg programs devoid of debugging symbols?
The build process creates ffmpeg_g, ffplay_g, etc. which contain full debug information. Those binaries are stripped to create ffmpeg, ffplay, etc. If you need the debug information, use the <a href="#id17"><span class="problematic" id="id18">*</span></a>_g versions.</p>
<p>4.7 I do not like the LGPL, can I contribute code under the GPL instead?
Yes, as long as the code is optional and can easily and cleanly be placed under #if CONFIG_GPL without breaking anything. So, for example, a new codec or filter would be OK under GPL while a bug fix to LGPL code would not.</p>
<p>4.8 I’m using FFmpeg from within my C application but the linker complains about missing symbols from the libraries themselves.
FFmpeg builds static libraries by default. In static libraries, dependencies are not handled. That has two consequences. First, you must specify the libraries in dependency order: -lavdevice must come before -lavformat, -lavutil must come after everything else, etc. Second, external libraries that are used in FFmpeg have to be specified too.</p>
<p>An easy way to get the full list of required libraries in dependency order is to use pkg-config.</p>
<p>c99 -o program program.c $(pkg-config –cflags –libs libavformat libavcodec)
See doc/example/Makefile and doc/example/pc-uninstalled for more details.</p>
<p>4.9 I’m using FFmpeg from within my C++ application but the linker complains about missing symbols which seem to be available.
FFmpeg is a pure C project, so to use the libraries within your C++ application you need to explicitly state that you are using a C library. You can do this by encompassing your FFmpeg includes using extern “C”.</p>
<p>See <a class="reference external" href="http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html#faq-32.3">http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html#faq-32.3</a></p>
<p>4.10 I’m using libavutil from within my C++ application but the compiler complains about ’UINT64_C’ was not declared in this scope
FFmpeg is a pure C project using C99 math features, in order to enable C++ to use them you have to append -D__STDC_CONSTANT_MACROS to your CXXFLAGS</p>
<p>4.11 I have a file in memory / a API different from <a href="#id19"><span class="problematic" id="id20">*</span></a>open/<a href="#id21"><span class="problematic" id="id22">*</span></a>read/ libc how do I use it with libavformat?
You have to create a custom AVIOContext using avio_alloc_context, see libavformat/aviobuf.c in FFmpeg and libmpdemux/demux_lavf.c in MPlayer or MPlayer2 sources.</p>
<p>4.12 Where is the documentation about ffv1, msmpeg4, asv1, 4xm?
see <a class="reference external" href="https://www.ffmpeg.org/~michael/">https://www.ffmpeg.org/~michael/</a></p>
<p>4.13 How do I feed H.263-RTP (and other codecs in RTP) to libavcodec?
Even if peculiar since it is network oriented, RTP is a container like any other. You have to demux RTP before feeding the payload to libavcodec. In this specific case please look at RFC 4629 to see how it should be done.</p>
<p>4.14 AVStream.r_frame_rate is wrong, it is much larger than the frame rate.
r_frame_rate is NOT the average frame rate, it is the smallest frame rate that can accurately represent all timestamps. So no, it is not wrong if it is larger than the average! For example, if you have mixed 25 and 30 fps content, then r_frame_rate will be 150 (it is the least common multiple). If you are looking for the average frame rate, see AVStream.avg_frame_rate.</p>
<p>4.15 Why is make fate not running all tests?
Make sure you have the fate-suite samples and the SAMPLES Make variable or FATE_SAMPLES environment variable or the –samples configure option is set to the right path.</p>
<p>4.16 Why is make fate not finding the samples?
Do you happen to have a ~ character in the samples path to indicate a home directory? The value is used in ways where the shell cannot expand it, causing FATE to not find files. Just replace ~ by the full path.</p>
<p>This document was generated on June 11, 2019 using makeinfo.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="general.html" class="btn btn-neutral float-right" title="General Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="libraries/libavfilter.html" class="btn btn-neutral float-left" title="Libavfilter Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, BandCap

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>